{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/ederivc/Documents/NEWHEROKU/frontend/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/ederivc/Documents/NEWHEROKU/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"C:/Users/ederivc/Documents/NEWHEROKU/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"C:/Users/ederivc/Documents/NEWHEROKU/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:/Users/ederivc/Documents/NEWHEROKU/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState,useRef}from\"react\";import{Button,Container,Form}from\"react-bootstrap\";import ReCAPTCHA from\"react-google-recaptcha\";import{Link,useHistory}from\"react-router-dom\";import{APIUsers}from\"../../api/api\";import useAuth from\"../../auth/useAuth\";import{Alerts}from\"../../components/FormUtilities\";import{captchaKey}from\"../../keys/keys\";import styles from\"./Login.module.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var LoginPage=function LoginPage(){var _useAuth=useAuth(),user=_useAuth.user,setUser=_useAuth.setUser;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),form=_useState2[0],setForm=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),showAlert=_useState4[0],setShowAlert=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),alertMsg=_useState6[0],setAlertMsg=_useState6[1];var captcha=useRef(null);var history=useHistory();var handleChange=function handleChange(e){setForm(_objectSpread(_objectSpread({},form),{},_defineProperty({},e.target.name,e.target.value)));};var handleAlert=function handleAlert(){setShowAlert(true);setTimeout(function(){setShowAlert(false);},3000);};var getUser=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(response){var json;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(response.status===200)){_context.next=7;break;}_context.next=3;return response.json();case 3:json=_context.sent;setUser(json);_context.next=9;break;case 7:setAlertMsg(\"Usuario o contraseña incorrectos\");handleAlert();case 9:case\"end\":return _context.stop();}}},_callee);}));return function getUser(_x){return _ref.apply(this,arguments);};}();useEffect(function(){var redirect=function redirect(){history.push(\"/cuenta\");};if(user)redirect();},[history,user]);var handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();if(!(captcha.current.getValue()===\"\")){_context2.next=5;break;}setAlertMsg(\"Debes aceptar el reCAPTCHA\");handleAlert();return _context2.abrupt(\"return\");case 5:_context2.next=7;return APIUsers.login({usera:form[\"email\"],password:form[\"password\"]});case 7:response=_context2.sent;getUser(response);case 9:case\"end\":return _context2.stop();}}},_callee2);}));return function handleSubmit(_x2){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:styles.wrapper,children:/*#__PURE__*/_jsxs(Container,{className:\"\".concat(styles.container),children:[/*#__PURE__*/_jsxs(Form,{className:styles.form,children:[/*#__PURE__*/_jsx(\"h1\",{className:styles.title,children:\"Iniciar Sesi\\xF3n\"}),showAlert?Alerts(alertMsg,\"danger\"):null,/*#__PURE__*/_jsxs(Form.Group,{controlId:\"formEmail\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Correo Electr\\xF3nico\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"email\",name:\"email\",onChange:handleChange})]}),/*#__PURE__*/_jsxs(Form.Group,{controlId:\"formPassword\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Contrase\\xF1a\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"password\",name:\"password\",onChange:handleChange})]}),/*#__PURE__*/_jsx(Container,{className:\"d-flex justify-content-center mb-2 mt-4\",children:/*#__PURE__*/_jsx(ReCAPTCHA,{ref:captcha,sitekey:captchaKey})}),/*#__PURE__*/_jsx(Button,{variant:\"success\",className:styles.submitBtn,onClick:handleSubmit,children:\"Iniciar Sesi\\xF3n\"}),/*#__PURE__*/_jsxs(Container,{className:styles.redirect,children:[\"\\xBFA\\xFAn no tienes cuenta? \",/*#__PURE__*/_jsx(Link,{to:\"/registro\",children:\"Registrate\"})]})]}),/*#__PURE__*/_jsx(Container,{className:\"\".concat(styles.imgContainer,\" d-none d-md-flex\"),children:/*#__PURE__*/_jsx(\"img\",{src:\"https://images-ext-1.discordapp.net/external/wgrUZvUhFjhapHFGUbFuDFgKS2a88VlwDgHS8G76dBA/https/www.pngkey.com/png/full/399-3993746_vet-png-veterinary-doctor-png.png\",alt:\"img\"})})]})});};export default LoginPage;","map":{"version":3,"sources":["C:/Users/ederivc/Documents/NEWHEROKU/frontend/src/pages/Login/LoginPage.jsx"],"names":["React","useEffect","useState","useRef","Button","Container","Form","ReCAPTCHA","Link","useHistory","APIUsers","useAuth","Alerts","captchaKey","styles","LoginPage","user","setUser","form","setForm","showAlert","setShowAlert","alertMsg","setAlertMsg","captcha","history","handleChange","e","target","name","value","handleAlert","setTimeout","getUser","response","status","json","redirect","push","handleSubmit","preventDefault","current","getValue","login","usera","password","wrapper","container","title","submitBtn","imgContainer"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\r\nimport { Button, Container, Form } from \"react-bootstrap\";\r\nimport ReCAPTCHA from \"react-google-recaptcha\";\r\nimport { Link, useHistory } from \"react-router-dom\";\r\nimport { APIUsers } from \"../../api/api\";\r\nimport useAuth from \"../../auth/useAuth\";\r\nimport { Alerts } from \"../../components/FormUtilities\";\r\nimport { captchaKey } from \"../../keys/keys\";\r\nimport styles from \"./Login.module.css\";\r\n\r\nconst LoginPage = () => {\r\n  const { user, setUser } = useAuth();\r\n  const [form, setForm] = useState({});\r\n  const [showAlert, setShowAlert] = useState();\r\n  const [alertMsg, setAlertMsg] = useState();\r\n  const captcha = useRef(null);\r\n  const history = useHistory();\r\n\r\n  const handleChange = (e) => {\r\n    setForm({\r\n      ...form,\r\n      [e.target.name]: e.target.value,\r\n    });\r\n  };\r\n\r\n  const handleAlert = () => {\r\n    setShowAlert(true);\r\n    setTimeout(() => {\r\n      setShowAlert(false);\r\n    }, 3000);\r\n  };\r\n\r\n  const getUser = async (response) => {\r\n    if (response.status === 200) {\r\n      const json = await response.json();\r\n      setUser(json);\r\n    } else {\r\n      setAlertMsg(\"Usuario o contraseña incorrectos\");\r\n      handleAlert();\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    const redirect = () => {\r\n      history.push(\"/cuenta\");\r\n    };\r\n    if (user) redirect();\r\n  }, [history, user]);\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    if (captcha.current.getValue() === \"\") {\r\n      setAlertMsg(\"Debes aceptar el reCAPTCHA\");\r\n      handleAlert();\r\n      return;\r\n    }\r\n    const response = await APIUsers.login({\r\n      usera: form[\"email\"],\r\n      password: form[\"password\"],\r\n    });\r\n    getUser(response);\r\n  };\r\n\r\n  return (\r\n    <div className={styles.wrapper}>\r\n      <Container className={`${styles.container}`}>\r\n        <Form className={styles.form}>\r\n          <h1 className={styles.title}>Iniciar Sesión</h1>\r\n          {showAlert ? Alerts(alertMsg, \"danger\") : null}\r\n          <Form.Group controlId=\"formEmail\">\r\n            <Form.Label>Correo Electrónico</Form.Label>\r\n            <Form.Control type=\"email\" name=\"email\" onChange={handleChange} />\r\n          </Form.Group>\r\n          <Form.Group controlId=\"formPassword\">\r\n            <Form.Label>Contraseña</Form.Label>\r\n            <Form.Control\r\n              type=\"password\"\r\n              name=\"password\"\r\n              onChange={handleChange}\r\n            />\r\n          </Form.Group>\r\n          <Container className=\"d-flex justify-content-center mb-2 mt-4\">\r\n            <ReCAPTCHA ref={captcha} sitekey={captchaKey} />\r\n          </Container>\r\n          <Button\r\n            variant=\"success\"\r\n            className={styles.submitBtn}\r\n            onClick={handleSubmit}\r\n          >\r\n            Iniciar Sesión\r\n          </Button>\r\n          <Container className={styles.redirect}>\r\n            ¿Aún no tienes cuenta? <Link to=\"/registro\">Registrate</Link>\r\n          </Container>\r\n        </Form>\r\n        <Container className={`${styles.imgContainer} d-none d-md-flex`}>\r\n          <img\r\n            src=\"https://images-ext-1.discordapp.net/external/wgrUZvUhFjhapHFGUbFuDFgKS2a88VlwDgHS8G76dBA/https/www.pngkey.com/png/full/399-3993746_vet-png-veterinary-doctor-png.png\"\r\n            alt=\"img\"\r\n          ></img>\r\n        </Container>\r\n      </Container>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default LoginPage;\r\n"]},"metadata":{},"sourceType":"module"}